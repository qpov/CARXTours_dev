{"ast":null,"code":"var _jsxFileName = \"A:\\\\CARXTours\\\\site\\\\frontend\\\\src\\\\pages\\\\Login.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../components/AuthContext';\nimport '../css/loginAndRegister.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nasync function login(username, password) {\n  const response = await fetch('http://localhost:8000/auth/login/', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      username,\n      password\n    })\n  });\n  if (response.ok) {\n    const data = await response.json();\n    console.log(data.userId);\n    return {\n      token: data.token,\n      userId: data.userId\n    };\n  } else {\n    throw new Error('Failed to log in');\n  }\n}\nconst Login = () => {\n  _s();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(null);\n  const [errorMessageClass, setErrorMessageClass] = useState('');\n  const {\n    setAuthToken,\n    setIsLoggedIn\n  } = useContext(AuthContext);\n  const navigate = useNavigate();\n  useEffect(() => {\n    if (error) {\n      setErrorMessageClass('visible');\n      const timer = setTimeout(() => {\n        setErrorMessageClass('');\n      }, 4000); // сообщение об ошибке исчезнет через 4 секунды\n\n      return () => {\n        clearTimeout(timer);\n      };\n    }\n  }, [error]);\n  const handleLogin = async e => {\n    e.preventDefault();\n    setError(null); // Обновляем состояние ошибки\n    try {\n      const result = await login(username, password);\n      if (result.token) {\n        setAuthToken(result.token);\n        setIsLoggedIn(true);\n        navigate('/');\n        localStorage.setItem('token', result.token);\n        localStorage.setItem('userId', result.userId);\n        localStorage.setItem('isLoggedIn', true);\n      }\n    } catch (error) {\n      setError('Неверное имя пользователя или пароль');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loginPage\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerLoginText\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerMainBack\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: '/',\n          children: \"\\u0413\\u043B\\u0430\\u0432\\u043D\\u0430\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"containerLoginAuth\",\n        children: \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0430\\u0446\\u0438\\u044F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"containerLoginTextUsername\",\n        children: \"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        value: username,\n        onChange: e => setUsername(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"containerLoginTextPassword\",\n        children: \"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"password\",\n        value: password,\n        onChange: e => setPassword(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"errorMessageContainer\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: `errorMessage ${errorMessageClass}`,\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerButton\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          onClick: handleLogin,\n          children: \"\\u0412\\u043E\\u0439\\u0442\\u0438\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"containerNoRegAndRegister\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"containerNoReg\",\n        children: \"\\u041D\\u0435 \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u044B?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"containerLoginRegister\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: '/register',\n          children: \"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"v4Re9SAIQb4PORai5ITNdVnqsUg=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["React","useContext","useState","useEffect","Link","useNavigate","AuthContext","jsxDEV","_jsxDEV","login","username","password","response","fetch","method","headers","body","JSON","stringify","ok","data","json","console","log","userId","token","Error","Login","_s","setUsername","setPassword","error","setError","errorMessageClass","setErrorMessageClass","setAuthToken","setIsLoggedIn","navigate","timer","setTimeout","clearTimeout","handleLogin","e","preventDefault","result","localStorage","setItem","className","children","to","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","target","type","onClick","_c","$RefreshReg$"],"sources":["A:/CARXTours/site/frontend/src/pages/Login.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../components/AuthContext';\r\nimport '../css/loginAndRegister.css';\r\n\r\nasync function login(username, password) {\r\n  const response = await fetch('http://localhost:8000/auth/login/', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({ username, password })\r\n  });\r\n\r\n  if (response.ok) {\r\n    const data = await response.json();\r\n    console.log(data.userId)\r\n    return { token: data.token, userId: data.userId };\r\n  } else {\r\n    throw new Error('Failed to log in');\r\n  }\r\n}\r\n\r\nconst Login = () => {\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(null);\r\n  const [errorMessageClass, setErrorMessageClass] = useState('');\r\n  const { setAuthToken, setIsLoggedIn } = useContext(AuthContext);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (error) {\r\n      setErrorMessageClass('visible');\r\n      const timer = setTimeout(() => {\r\n        setErrorMessageClass('');\r\n      }, 4000); // сообщение об ошибке исчезнет через 4 секунды\r\n\r\n      return () => {\r\n        clearTimeout(timer);\r\n      }\r\n    }\r\n  }, [error]);\r\n\r\n  const handleLogin = async (e) => {\r\n    e.preventDefault();\r\n    setError(null); // Обновляем состояние ошибки\r\n    try {\r\n      const result = await login(username, password);\r\n      if (result.token) {\r\n        setAuthToken(result.token);\r\n        setIsLoggedIn(true);\r\n        navigate('/');\r\n        localStorage.setItem('token', result.token);\r\n        localStorage.setItem('userId', result.userId);\r\n        localStorage.setItem('isLoggedIn', true);\r\n      }\r\n    } catch (error) {\r\n      setError('Неверное имя пользователя или пароль');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className='loginPage'>\r\n      <div className='containerLoginText'>\r\n        <div className='containerMainBack'>\r\n          <Link to={'/'}>Главная</Link>\r\n        </div>\r\n        <p className='containerLoginAuth'>Авторизация</p>\r\n        <p className='containerLoginTextUsername'>Имя пользователя</p>\r\n        <input value={username} onChange={(e) => setUsername(e.target.value)}></input>\r\n        <p className='containerLoginTextPassword'>Пароль</p>\r\n        <input type=\"password\" value={password} onChange={(e) => setPassword(e.target.value)}></input>\r\n        <div className='errorMessageContainer'>\r\n          <p className={`errorMessage ${errorMessageClass}`}>{error}</p>\r\n        </div>\r\n        <div className='containerButton'>\r\n          <button type=\"submit\" onClick={handleLogin}>\r\n            Войти\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className='containerNoRegAndRegister'>\r\n        <p className='containerNoReg'>Не зарегистрированы?</p>\r\n        <div className='containerLoginRegister'>\r\n          <Link to={'/register'}>Регистрация</Link>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}